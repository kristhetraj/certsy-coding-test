(()=>{"use strict";var e=new Konva.Stage({container:"container",width:1e3,height:500}),t=new Konva.Layer;e.add(t);const a=({x:e,y:a,text:n,fontSize:o=18,fontFamily:s="Calibri",fill:r="black",width:i=300,padding:d=20,align:x="center"})=>(n=new Konva.Text({x:e,y:a,text:n,fontSize:o,fontFamily:s,fill:r,width:i,padding:d,align:x}),t.add(n),n),n=({x:e,y:a,width:n,height:o,fill:s,stroke:r="black",strokeWidth:i=1})=>{var d=new Konva.Rect({x:e,y:a,width:n,height:o,fill:s,stroke:r,strokeWidth:i});return t.add(d),d},o=({x:e,y:a,radius:n,fill:o,stroke:s="black",strokeWidth:r=1})=>{var i=new Konva.Circle({x:e,y:a,radius:n,fill:o,stroke:s,strokeWidth:r});return t.add(i),i};t.draw();const s=50;a({x:400,y:50,text:"[Instructions]\n\nTop arrow = forward\nBack arrow = backward\nLeft arrow = rotate left\nRight arrow = rotate right\nSpace bar = Report"});var r=a({x:400,y:200,text:"[Commands]\n\n"});const i=[],d=e=>{i.push(e);const t=i.slice(i.length-Math.min(10,i.length)).reduce(((e,t)=>`${e}\n${t}`),"[Commands]\n\n");r.text(t)};n({x:100,y:100,width:300,height:300,fill:"green"});var x=n({x:150,y:150,width:s,height:s,fill:"blue"}),y=o({x:125,y:125,radius:25,fill:"red"}),l=o({x:y.x()+12.5,y:y.y(),radius:6.25,fill:"pink"});const c="EAST",k="WEST",h="NORTH",f="SOUTH",w="FORWARD",P="BACKWARD";let b=c;const u=e=>{switch(b=e,b){case c:l.x(y.x()+12.5),l.y(y.y());break;case k:l.x(y.x()-12.5),l.y(y.y());break;case h:l.x(y.x()),l.y(y.y()-12.5);break;case f:l.x(y.x()),l.y(y.y()+12.5)}},g=({wallCheckOkay:e,nextBodyPosX:t,nextBodyPosY:a,nextHeadPosX:n,nextHeadPosY:o})=>{const r=((e,t)=>{const a=x.x(),n=x.y();return e<a||e>a+s||t<n||t>n+s})(t,a);return e&&r?(y.x(t),y.y(a),l.x(n),l.y(o),"success"):"fail"},v=(e="FORWARD")=>{let t="";if(t+=e===w?"move forward: ":"move backward: ",b===c&&e===w||b===k&&e===P){const e=y.x()+s,a=y.y();t+=g({wallCheckOkay:e<400,nextBodyPosX:e,nextBodyPosY:a,nextHeadPosX:l.x()+s,nextHeadPosY:l.y()})}else if(b===k&&e===w||b===c&&e===P){const e=y.x()-s,a=y.y();t+=g({wallCheckOkay:e>100,nextBodyPosX:e,nextBodyPosY:a,nextHeadPosX:l.x()-s,nextHeadPosY:l.y()})}else if(b===h&&e===w||b===f&&e===P){const e=y.x(),a=y.y()-s;t+=g({wallCheckOkay:a>100,nextBodyPosX:e,nextBodyPosY:a,nextHeadPosX:l.x(),nextHeadPosY:l.y()-s})}else if(b===f&&e===w||b===h&&e===P){const e=y.x(),a=y.y()+s;t+=g({wallCheckOkay:a<400,nextBodyPosX:e,nextBodyPosY:a,nextHeadPosX:l.x(),nextHeadPosY:l.y()+s})}d(t)};var C,B;C=e=>{if(32===e.keyCode&&d(`direction: ${b}, x: ${y.x()-100-25}, y:${y.y()-100-25}`),37===e.keyCode)d("rotate left"),(()=>{switch(b){case c:u(h);break;case k:u(f);break;case h:u(k);break;case f:u(c)}})();else if(38===e.keyCode)v();else if(39===e.keyCode)d("rotate right"),(()=>{switch(b){case c:u(f);break;case k:u(h);break;case h:u(c);break;case f:u(k)}})();else{if(40!==e.keyCode)return;v(P)}e.preventDefault()},(B=e.container()).tabIndex=1,B.focus(),B.addEventListener("keydown",C)})();