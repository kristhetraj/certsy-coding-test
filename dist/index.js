(()=>{"use strict";const t="EAST",e="WEST",o="NORTH",i="SOUTH",a="FORWARD",r="BACKWARD",n="LEFT",d="RIGHT",s=({newOrientation:a,robotHead:r,robotBody:n,gridSize:d})=>{switch(a){case o:r.x(n.x()),r.y(n.y()-d/4);break;case i:r.x(n.x()),r.y(n.y()+d/4);break;case t:r.x(n.x()+d/4),r.y(n.y());break;case e:r.x(n.x()-d/4),r.y(n.y())}return a},l=(({container:t="container",width:e,height:o})=>{var i=new Konva.Stage({container:t,width:e,height:o}),a=new Konva.Layer;return i.add(a),a.draw(),{addText:({x:t,y:e,text:o,fontSize:i=18,fontFamily:r="Calibri",fill:n="black",width:d=350,padding:s=20,align:l="center"})=>(o=new Konva.Text({x:t,y:e,text:o,fontSize:i,fontFamily:r,fill:n,width:d,padding:s,align:l}),a.add(o),o),addRectangle:({x:t,y:e,width:o,height:i,fill:r,stroke:n="black",strokeWidth:d=1})=>{var s=new Konva.Rect({x:t,y:e,width:o,height:i,fill:r,stroke:n,strokeWidth:d});return a.add(s),s},addCircle:({x:t,y:e,radius:o,fill:i,stroke:r="black",strokeWidth:n=1})=>{var d=new Konva.Circle({x:t,y:e,radius:o,fill:i,stroke:r,strokeWidth:n});return a.add(d),d},addUiEventListener:(t,e)=>{var o=i.container();o.tabIndex=1,o.focus(),o.addEventListener(t,e)}}})({container:"ui-container",width:650,height:450});l.addText({x:300,y:0,text:"[Instructions]\n\nTop arrow = forward\nBack arrow = backward\nLeft arrow = rotate left\nRight arrow = rotate right\nSpace bar = Report"});var c=l.addText({x:300,y:150,text:"[Activity Log]\n\n"});const y=[],x=t=>{y.push(t);const e=y.slice(y.length-Math.min(10,y.length)).reduce(((t,e)=>`${t}\n${e}`),"[Activity Log]\n\n");c.text(e)};l.addRectangle({x:50,y:50,width:250,height:250,fill:"green"});const b=(({gridSize:l,leftWall:c,rightWall:y,topWall:x,bottomWall:b,canvas:h})=>{const f=l/2,g=h.addCircle({x:c+l/2,y:x+l/2,radius:l/2,fill:"red"}),w=1/8*l,m=h.addCircle({x:g.x()+l/4,y:g.y(),radius:w,fill:"pink"});let k=t;return{rotate:a=>{k=(({robotOrientation:a,rotateDirection:r,robotHead:l,robotBody:c,gridSize:y})=>{let x;return a===t&&r===n||a===e&&r===d?x=o:a===t&&r===d||a===e&&r===n?x=i:a===i&&r===n||a===o&&r===d?x=t:(a===o&&r===n||a===i&&r===d)&&(x=e),s({newOrientation:x,robotHead:l,robotBody:c,gridSize:y})})({robotOrientation:k,rotateDirection:a,robotHead:m,robotBody:g,gridSize:l})},move:n=>(({robotOrientation:n,moveDirection:d,robotBody:s,robotHead:l,gridSize:c,leftWall:y,rightWall:x,topWall:b,bottomWall:h})=>{let f=d===a?"move forward: ":"move backward: ";if(n===t&&d===a||n===e&&d===r){const t=s.x()+c,e=s.y(),o=!0;t<x&&o?(s.x(t),s.y(e),l.x(l.x()+c),l.y(l.y()),f+="success"):f+="fail"}else if(n===e&&d===a||n===t&&d===r){const t=s.x()-c,e=s.y(),o=!0;t>y&&o?(s.x(t),s.y(e),l.x(l.x()-c),l.y(l.y()),f+="success"):f+="fail"}else if(n===o&&d===a||n===i&&d===r){const t=s.x(),e=s.y()-c,o=!0;e>b&&o?(s.x(t),s.y(e),l.x(l.x()),l.y(l.y()-c),f+="success"):f+="fail"}else if(n===i&&d===a||n===o&&d===r){const t=s.x(),e=s.y()+c,o=!0;e<h&&o?(s.x(t),s.y(e),l.x(l.x()),l.y(l.y()+c),f+="success"):f+="fail"}return f})({robotOrientation:k,moveDirection:n,robotBody:g,robotHead:m,gridSize:l,leftWall:c,rightWall:y,topWall:x,bottomWall:b}),place:({newRobotX:t,newRobotY:e,newOrientation:o})=>{g.x(c+l/2+t*l),g.y(x+l/2+e*l),m.x(g.x()+l/4),m.y(g.y()),k=s({newOrientation:o,gridSize:l,robotBody:g,robotHead:m})},getPosition:()=>({x:g.x()-c-f,y:g.y()-x-f,orientation:k})}})({gridSize:50,leftWall:50,rightWall:300,topWall:50,bottomWall:300,canvas:l}),h="PLACE",f="MOVE",g="REVERSE",w="LEFT",m="RIGHT",k="REPORT";l.addUiEventListener("keydown",(t=>{if(32===t.keyCode&&u(k),37===t.keyCode)u(w);else if(38===t.keyCode)u(f);else if(39===t.keyCode)u(m);else{if(40!==t.keyCode)return;u(g)}t.preventDefault()}));const u=(t,e)=>{switch(t){case h:x(`place (x: ${e.newRobotX}, y: ${e.newRobotY}, orientation: ${e.newOrientation})`),b.place(e);break;case f:const t=b.move(a);x(t);break;case g:const o=b.move(r);x(o);break;case w:x("rotate left"),b.rotate(n);break;case m:x("rotate right"),b.rotate(d);break;case k:const i=b.getPosition();x(`report (x: ${i.x/50}, y:${4-i.y/50}, orientation: ${i.orientation})`)}},W={commands:document.getElementById("commands"),submitCommands:document.getElementById("submit-commands")};W.submitCommands.addEventListener("click",(()=>{const t=W.commands.value.split("\n"),e=t.findIndex((t=>t.startsWith(h)));e<0||t.slice(e).forEach((t=>{if(t.startsWith(h)){const e=t.substring(6).split(",");u(h,{newRobotX:e[0],newRobotY:4-e[1],newOrientation:e[2]})}else t.startsWith(f)?u(f):t.startsWith(g)?u(g):t.startsWith(w)?u(w):t.startsWith(m)?u(m):t.startsWith(k)&&u(k)}))}),!1)})();