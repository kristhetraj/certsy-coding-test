(()=>{"use strict";var t=new Konva.Stage({container:"container",width:1e3,height:500}),e=new Konva.Layer;t.add(e);const o=({x:t,y:o,text:i,fontSize:r=18,fontFamily:a="Calibri",fill:n="black",width:l=300,padding:d=20,align:s="center"})=>(i=new Konva.Text({x:t,y:o,text:i,fontSize:r,fontFamily:a,fill:n,width:l,padding:d,align:s}),e.add(i),i),i=({x:t,y:o,radius:i,fill:r,stroke:a="black",strokeWidth:n=1})=>{var l=new Konva.Circle({x:t,y:o,radius:i,fill:r,stroke:a,strokeWidth:n});return e.add(l),l};e.draw();const r="EAST",a="WEST",n="NORTH",l="SOUTH",d="FORWARD",s="BACKWARD",y="LEFT",x="RIGHT",c=({robotOrientation:t,rotateDirection:e,robotHead:o,robotBody:i,gridSize:d})=>t===r&&e===y||t===a&&e===x?(o.x(i.x()),o.y(i.y()-d/4),n):t===r&&e===x||t===a&&e===y?(o.x(i.x()),o.y(i.y()+d/4),l):t===l&&e===y||t===n&&e===x?(o.x(i.x()+d/4),o.y(i.y()),r):t===n&&e===y||t===l&&e===x?(o.x(i.x()-d/4),o.y(i.y()),a):void 0;o({x:400,y:50,text:"[Instructions]\n\nTop arrow = forward\nBack arrow = backward\nLeft arrow = rotate left\nRight arrow = rotate right\nSpace bar = Report"});var f=o({x:400,y:200,text:"[Commands]\n\n"});const h=[],b=t=>{h.push(t);const e=h.slice(h.length-Math.min(10,h.length)).reduce(((t,e)=>`${t}\n${e}`),"[Commands]\n\n");f.text(e)};(({x:t,y:o,width:i,height:r,fill:a,stroke:n="black",strokeWidth:l=1})=>{var d=new Konva.Rect({x:t,y:o,width:i,height:r,fill:a,stroke:n,strokeWidth:l});e.add(d)})({x:100,y:100,width:300,height:300,fill:"green"});const g=(({gridSize:t,leftWall:e,rightWall:o,topWall:f,bottomWall:h})=>{const b=t/2,g=i({x:e+t/2,y:f+t/2,radius:t/2,fill:"red"}),W=1/8*t,k=i({x:g.x()+t/4,y:g.y(),radius:W,fill:"pink"});let w=r;return{rotateLeft:()=>{w=c({robotOrientation:w,rotateDirection:y,robotHead:k,robotBody:g,gridSize:t})},rotateRight:()=>{w=c({robotOrientation:w,rotateDirection:x,robotHead:k,robotBody:g,gridSize:t})},sendRobotMove:i=>(({robotOrientation:t,moveDirection:e,robotBody:o,robotHead:i,gridSize:y,leftWall:x,rightWall:c,topWall:f,bottomWall:h})=>{let b=e===d?"move forward: ":"move backward: ";if(t===r&&e===d||t===a&&e===s){const t=o.x()+y,e=o.y(),r=!0;t<c&&r?(o.x(t),o.y(e),i.x(i.x()+y),i.y(i.y()),b+="success"):b+="fail"}else if(t===a&&e===d||t===r&&e===s){const t=o.x()-y,e=o.y(),r=!0;t>x&&r?(o.x(t),o.y(e),i.x(i.x()-y),i.y(i.y()),b+="success"):b+="fail"}else if(t===n&&e===d||t===l&&e===s){const t=o.x(),e=o.y()-y,r=!0;e>f&&r?(o.x(t),o.y(e),i.x(i.x()),i.y(i.y()-y),b+="success"):b+="fail"}else if(t===l&&e===d||t===n&&e===s){const t=o.x(),e=o.y()+y,r=!0;e<h&&r?(o.x(t),o.y(e),i.x(i.x()),i.y(i.y()+y),b+="success"):b+="fail"}return b})({robotOrientation:w,moveDirection:i,robotBody:g,robotHead:k,gridSize:t,leftWall:e,rightWall:o,topWall:f,bottomWall:h}),getPosition:()=>({x:g.x()-e-b,y:g.y()-f-b,orientation:w})}})({gridSize:50,leftWall:100,rightWall:400,topWall:100,bottomWall:400});var W,k;W=t=>{if(32===t.keyCode){const t=g.getPosition();b(`direction: ${t.orientation}, x: ${t.x}, y:${t.y}`)}if(37===t.keyCode)b("rotate left"),g.rotateLeft();else if(38===t.keyCode){const t=g.sendRobotMove(d);b(t)}else if(39===t.keyCode)b("rotate right"),g.rotateRight();else{if(40!==t.keyCode)return;{const t=g.sendRobotMove(s);b(t)}}t.preventDefault()},(k=t.container()).tabIndex=1,k.focus(),k.addEventListener("keydown",W)})();